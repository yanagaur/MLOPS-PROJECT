import{r as l,j as e}from"./@radix-DnFH_oo1.js";import{b as p,u as y,a as D,S as v,E as S}from"./SecretTooltip-BaMwHF-Q.js";import{a as h,c as w}from"./@tanstack-QbMbTrh5.js";import{ar as N,aE as b,ai as E,aj as k,ak as T,I as g,al as V,am as L,f as C,D as A,q as K,s as O,S as H,a7 as B,a8 as R,G as M,N as q,B as z}from"./index-Ci0nJ8EZ.js";import{C as F}from"./CopyButton-DcFHidFJ.js";import{S as I}from"./dots-horizontal-C6K59vUm.js";import{S as Q}from"./trash-DUWZWzse.js";import{A as P}from"./AlertDialogDropdownItem-xLR9a1iw.js";import{g as Z}from"./@react-router-APVeuk-U.js";import"./plus-Bc8eLSDM.js";import"./url-CbAPzsmT.js";import"./zod-uFd1wBcd.js";import"./index.esm-BE1uqCX5.js";import"./CodeSnippet-IxXNxUDa.js";import"./copy-CaGlDsUy.js";import"./@reactflow-ytavUpwh.js";const _=s=>l.createElement("svg",{viewBox:"0 0 24 24",fill:"black",xmlns:"http://www.w3.org/2000/svg",...s},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.99995 9C7.99995 5.13401 11.134 2 14.9999 2C18.8659 2 21.9999 5.13401 21.9999 9C21.9999 12.866 18.8659 16 14.9999 16C14.6816 16 14.3677 15.9787 14.0597 15.9373C13.8347 15.907 13.6939 15.8883 13.5912 15.8784C13.5729 15.8766 13.5579 15.8753 13.5458 15.8745C13.5428 15.8771 13.5395 15.8801 13.5359 15.8833C13.4825 15.9321 13.4121 16.0021 13.2862 16.128L11.7071 17.7071C11.5195 17.8946 11.2652 18 10.9999 18H9.99995V19C9.99995 19.5523 9.55223 20 8.99995 20H7.99995V21C7.99995 21.5523 7.55223 22 6.99995 22L4.56803 22C4.31565 22 4.06987 22.0001 3.86172 21.9831C3.63312 21.9644 3.36339 21.9203 3.09197 21.782C2.71564 21.5903 2.40968 21.2843 2.21793 20.908C2.07964 20.6366 2.03557 20.3668 2.01689 20.1382C1.99988 19.9301 1.99991 19.6843 1.99994 19.4319L1.99995 17.6627C1.99995 17.6462 1.9999 17.6291 1.99985 17.6117C1.99935 17.4218 1.99871 17.1827 2.05521 16.9473C2.1042 16.7432 2.18501 16.5482 2.29467 16.3692C2.42112 16.1629 2.59067 15.9942 2.72532 15.8603C2.73768 15.848 2.74975 15.836 2.76147 15.8243L7.87197 10.7138C7.99789 10.5878 8.06789 10.5175 8.1166 10.464C8.11984 10.4604 8.1228 10.4572 8.12549 10.4541C8.12461 10.442 8.12336 10.427 8.12159 10.4087C8.11168 10.3061 8.09292 10.1653 8.06267 9.94028C8.02127 9.63227 7.99995 9.31836 7.99995 9ZM7.99995 18V17C7.99995 16.4477 8.44766 16 8.99995 16H10.5857L11.872 14.7138C11.889 14.6967 11.9065 14.6791 11.9244 14.6611C12.1036 14.4807 12.3216 14.2613 12.5701 14.1224C12.8036 13.9919 12.9981 13.9262 13.2628 13.8884C13.4562 13.8607 13.6445 13.8742 13.7834 13.8876C13.928 13.9016 14.1065 13.9256 14.3084 13.9527L14.3262 13.9551C14.5461 13.9847 14.771 14 14.9999 14C17.7614 14 19.9999 11.7614 19.9999 9C19.9999 6.23858 17.7614 4 14.9999 4C12.2385 4 9.99995 6.23858 9.99995 9C9.99995 9.22899 10.0153 9.45388 10.0448 9.67379L10.0472 9.6916C10.0744 9.89344 10.0984 10.072 10.1123 10.2165C10.1258 10.3555 10.1393 10.5438 10.1116 10.7372C10.0737 11.0019 10.008 11.1964 9.87753 11.4298C9.73863 11.6783 9.5192 11.8963 9.33879 12.0756C9.32083 12.0934 9.30326 12.1109 9.28619 12.128L4.17568 17.2385C4.08305 17.3311 4.03699 17.3775 4.00494 17.4126C4.0041 17.4135 4.0033 17.4144 4.00253 17.4153C4.00247 17.4164 4.00241 17.4176 4.00236 17.4189C4.00019 17.4664 3.99995 17.5317 3.99995 17.6627V19.4C3.99995 19.6965 4.00072 19.8588 4.01025 19.9754C4.01063 19.98 4.01101 19.9844 4.01139 19.9885C4.01554 19.9889 4.01994 19.9893 4.02458 19.9897C4.14117 19.9992 4.30342 20 4.59995 20H5.99995V19C5.99995 18.4477 6.44766 18 6.99995 18H7.99995ZM13.9999 7C13.9999 6.44772 14.4477 6 14.9999 6C15.7662 6 16.5357 6.29309 17.1213 6.87868C17.7068 7.46425 17.9999 8.23372 17.9999 8.99991C18 9.5522 17.5523 9.99993 17 9.99994C16.4477 9.99996 16 9.55226 15.9999 8.99997C15.9999 8.74251 15.9025 8.48834 15.7071 8.29289C15.5116 8.09743 15.2574 8 14.9999 8C14.4477 8 13.9999 7.55229 13.9999 7Z"}));function $({secretId:s,keyName:r}){const{data:t,isLoading:a,isError:u}=h({...p.secretDetail(s)}),i=w(),{mutate:c}=y({onError(d){N(d)&&b({status:"error",emphasis:"subtle",description:d.message,rounded:!0})},onSuccess(){i.invalidateQueries({queryKey:["secrets"]}),i.invalidateQueries({queryKey:["secretDetail",s]})}}),[n,m]=l.useState(""),x=()=>{var d;if(t){const f={...(d=t.body)==null?void 0:d.values};delete f[r];const j={name:t.name,scope:"workspace",values:f};c({id:s,body:j})}};function o(d){m(d.target.value)}return a?e.jsx("div",{children:"Loading..."}):u?e.jsx("div",{children:"Error loading secret details"}):e.jsxs(E,{children:[e.jsx(k,{children:e.jsx(T,{children:"Delete Key"})}),e.jsxs("div",{className:"gap-5 p-5",children:[e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"Are you sure you want to delete this key?"}),e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"This action cannot be undone."}),e.jsx("h3",{className:"font-inter text-sm mb-1 mt-4 text-left font-medium leading-5",children:"Please type DELETE to confirm"}),e.jsx(g,{name:"key",onChange:o,className:"w-full",required:!0,value:n})]}),e.jsxs(V,{className:"gap-[10px]",children:[e.jsx(L,{asChild:!0,children:e.jsx(C,{size:"sm",intent:"secondary",children:"Cancel"})}),e.jsx(C,{intent:"danger",type:"button",onClick:x,disabled:n!=="DELETE",children:"Delete"})]})]})}function G({secretId:s,keyName:r}){const[t,a]=l.useState(!1),[u,i]=l.useState(!1),c=l.useRef(null),n=l.useRef(null);function m(){n.current=c.current}function x(o){if(o===!1){a(!1),setTimeout(()=>{i(o)},200);return}i(o)}return e.jsxs(A,{onOpenChange:a,open:t,children:[e.jsx(K,{ref:c,children:e.jsx(I,{className:"h-4 w-4 fill-theme-text-tertiary"})}),e.jsx(O,{hidden:u,onCloseAutoFocus:o=>{n.current&&(n.current.focus(),n.current=null,o.preventDefault())},align:"end",sideOffset:7,children:e.jsx(P,{onSelect:m,onOpenChange:x,triggerChildren:"Delete ",icon:e.jsx(Q,{}),children:e.jsx($,{secretId:s,keyName:r})})})]})}const U=({value:s})=>{const[r,t]=l.useState(!1),a=typeof s=="string"?s:"",u="â€¢".repeat(a.length);return e.jsxs("div",{className:"flex  items-center gap-2 space-x-2",children:[e.jsx(v,{onClick:()=>t(!r),className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:r?a:u})]})};function J(s,r){return[{id:"key",header:"Key",accessorKey:"key",cell:({row:t})=>{const a=`from zenml.client import Client
secret = Client().get_secret(${r})
	  
# 'secret.secret_values' will contain a dictionary with all key-value pairs within your secret.
secret.secret_values["${t.original.key}"]
	  `;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-5 w-5 flex-shrink-0 fill-primary-400"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:t.original.key}),e.jsx(D,{code:a})]})})})]})}},{id:"value",header:"Value",accessorKey:"value",cell:({row:t})=>e.jsx(U,{value:t.getValue("value")})},{id:"actions",header:"",cell:({row:t})=>e.jsx(G,{secretId:s,keyName:t.original.key})}]}function W({secretId:s}){var c;const[r,t]=l.useState(""),a=h({...p.secretDetail(s)});if(a.isPending)return e.jsx(H,{className:"h-[200px] w-full"});if(a.isError)return e.jsx("div",{children:a.error.message});const i=Object.entries(((c=a.data.body)==null?void 0:c.values)||{}).map(([n,m])=>({key:n,value:m})).filter(n=>n.key.toLowerCase().includes(r.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-2",children:[e.jsx(g,{type:"text",placeholder:"Search Keys...",value:r,onChange:n=>t(n.target.value),inputSize:"md"}),e.jsxs(B,{children:[e.jsx(R,{asChild:!0,children:e.jsx(C,{size:"sm",intent:"primary",children:"Edit Keys"})}),e.jsx(S,{secretId:s,isSecretNameEditable:!1,dialogTitle:"Edit keys"})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(M,{columns:J(s,a.data.name),data:i})})]})}function Ce(){const{secretId:s}=Z(),{setCurrentBreadcrumbData:r}=q(),{data:t}=h({...p.secretDetail(s||"")});return l.useEffect(()=>{t&&r({segment:"secretsDetail",data:{name:t.name,id:t.id}})},[t]),e.jsx(e.Fragment,{children:e.jsxs(z,{className:"space-y-5 p-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-text-xl font-semibold",children:t==null?void 0:t.name}),e.jsxs("div",{className:"group/copybutton flex items-center space-x-1",children:[e.jsx("div",{className:"text-theme-text-secondary",children:s==null?void 0:s.slice(0,8)}),e.jsx(F,{copyText:s})]})]}),e.jsx(W,{secretId:s||""})]})})}export{Ce as default};
